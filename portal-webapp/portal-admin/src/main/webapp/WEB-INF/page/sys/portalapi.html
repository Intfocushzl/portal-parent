<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JSONView</title>

    #parse("sys/header.html")

    <link rel="stylesheet" href="${rc.contextPath}/statics/plugins/jquery-jsonview/jquery.jsonview.css"/>
    <script src="${rc.contextPath}/statics/plugins/jquery-jsonview/jquery.jsonview.js"></script>
    <script src="${rc.contextPath}/statics/plugins/jquery-jsonview/autosize.js"></script>

    <style>
        .form-group {
            margin-top: 20px;
            padding: 20px;
        }

        .json_formatter {
            padding: 20px;
            min-height: 500px;;
            height: auto;
            width: 100%;
            float: left;
        }

        #json {
            border: 1px solid rgba(82, 168, 236, 0.8);
            min-height: 400px;
        }

        .json_btn {
            margin-bottom: 10px;
        }

        #goTopBtn {
            position: fixed;
            line-height: 46px;
            width: 46px;
            bottom: 30px;
            height: 46px;
            cursor: pointer;
            display: none;
            background: url(/statics/css/img/top-up.png);
        }

        .col-sm-2 {
            width: 120px;
        }
    </style>

</head>
<body>
<div id="rrapp">
    <div class="form-group">
        <div class="col-sm-2 control-label">
            <button class="btn btn-success" onclick="getJsonTest()">测试环境</button>
        </div>
        <div class="col-sm-10">
            <input type="text" name="test_url" id="test_url" class="form-control" placeholder="请求地址"/>
        </div>
    </div>

    <div class="form-group">
        <div class="col-sm-2 control-label">
            <button class="btn btn-success" onclick="getJsonDev()">生产环境</button>
        </div>
        <div class="col-sm-10">
            <input type="text" name="dev_url" id="dev_url" class="form-control" placeholder="请求地址"/>
        </div>
    </div>

    <div class="form-group form-group-json">
        <div class="json_formatter">
            <div class="json_btn json_formatter_btn">
                <button id="toggle-btn" class="btn btn-primary">　展　开　</button>
                <button id="toggle-level1-btn" class="btn btn-danger">　一　级　</button>
                <button id="toggle-level2-btn" class="btn btn-danger">　二　级　</button>
                <button id="toggle-level3-btn" class="btn btn-danger">　三　级　</button>
                <button id="toggle-level4-btn" class="btn btn-danger">　四　级　</button>
                <button id="toggle-level5-btn" class="btn btn-danger">　五　级　</button>
            </div>
            <div id="json"></div>
        </div>
    </div>
</div>

<div id="goTopBtn"></div>

<script type="text/javascript">
    // 获取 window.location.href参数
    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]);
        return null;
    }

    var code = JSON.parse(unescape(getQueryString("code")));

    $(function () {
        $('#toggle-formatter').on('click', function () {
            $("#json").JSONView($("#json_str_text").val());
        });

        $('#toggle-btn').on('click', function () {
            $('#json').JSONView('toggle');
        });

        $('#toggle-level1-btn').on('click', function () {
            $('#json').JSONView('toggle', 1);
        });

        $('#toggle-level2-btn').on('click', function () {
            $('#json').JSONView('toggle', 2);
        });

        $('#toggle-level3-btn').on('click', function () {
            $('#json').JSONView('toggle', 3);
        });

        $('#toggle-level4-btn').on('click', function () {
            $('#json').JSONView('toggle', 4);
        });

        $('#toggle-level5-btn').on('click', function () {
            $('#json').JSONView('toggle', 5);
        });
    });
</script>

<script type="text/javascript">
    $(window).scroll(function () {
        var sc = $(window).scrollTop();
        var rwidth = $(window).width()
        if (sc > 0) {
            $("#goTopBtn").css("display", "block");
            $("#goTopBtn").css("left", (rwidth - 48) + "px")
        } else {
            $("#goTopBtn").css("display", "none");
        }
    })
    $("#goTopBtn").click(function () {
        var sc = $(window).scrollTop();
        $('body,html').animate({scrollTop: 0}, 500);
    })
</script>

<script>
    var test_url = "http://10.67.241.218/yhportal/userAuthMenu/listRoleMenu?roleId=1&token=adminMGdp1nT0Q3qxBqDvFNKW0QM9354d8db013b4bb08d4e116e6fd1893e";
    //var test_url = "http://10.67.241.218/yhportal/api/portal/custom?yongHuiReportCustomCode=REP_000003&reportLabel=2&sDate=2017/6/19&eDate=2017/7/19&holdName=%E7%AC%AC%E4%BA%8C%E9%9B%86%E7%BE%A4&classId=&areaId=&areaMans=&shopId=&token=adminMGdp1nT0Q3qxBqDvFNKW0QM9354d8db013b4bb08d4e116e6fd1893e";
    //var test_url = "http://10.67.241.218/yhportal/api/portal/custom?token=CS123456mXB84h6U5FUO7nsdu0Eq7c5373b211054c7b8681fe829c62cc2c";
    var dev_url = "http://10.67.241.234/yhportal/api/portal/custom?token=CS123456mXB84h6U5FUO7nsdu0Eq7c5373b211054c7b8681fe829c62cc2c";

    $("#test_url").val(test_url);
    $("#dev_url").val(dev_url);

    function getJsonTest() {
        $.get(test_url, function (r) {
            $(".json_str_text").val(JSON.stringify(r));
            $("#json").JSONView(JSON.stringify(r));
        });
    }

    function getJsonDev() {
        $.get(dev_url, function (r) {
            $(".json_str_text").val(JSON.stringify(r));
            $("#json").JSONView(JSON.stringify(r));
        });
    }
</script>

</body>
</html>
